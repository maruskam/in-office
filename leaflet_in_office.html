<!-- visualizzo sulla mappa dati geojson
query db 
select json_build_object(
    'type', 'FeatureCollection',
    'features', json_agg(ST_AsGeoJSON(t.*)::json)
    )
from (select id, name, concat(name, ' ', type) as popupContent, ST_Transform(wkb_geometry::geometry, 4326) from ufficio_dump2
     ) as t(id, name, popupContent, geom);
-->
<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>The HTML5 Herald</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">
    <style>
        #mapid { height: 580px; background-color: azure;}
    </style>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" 
    integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
    crossorigin=""/>
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
    integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
    crossorigin=""></script>


</head>

<body>
    <div id="mapid"></div>
    <script>
        var map = L.map('mapid').setView([43.90133,12.85695], 22);
       /* L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);*/
        var myStyle = {
            "color": "#ff7800",
            "weight": 5,
            "opacity": 0.65
        };
        
        var states ={"type" : "FeatureCollection", "features" : [{"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856864214,43.90132334],[12.857006508,43.901470116],[12.857249905,43.901353019],[12.857152546,43.901252649],[12.857099373,43.901279091],[12.857052192,43.901229985],[12.856864214,43.90132334]]]]}, "properties": {"id": null, "name": null, "type": "building_outline", "description": " building_outline"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856880128,43.901337033],[12.856909523,43.901366307],[12.856959513,43.901343238],[12.856950713,43.901335953],[12.856962883,43.901330152],[12.856927123,43.901292952],[12.856892298,43.901309546],[12.856908774,43.901324082],[12.856880128,43.901337033]]]]}, "properties": {"id": null, "name": "room 6", "type": "room", "description": "room 6 room"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856953569,43.901334739],[12.856954505,43.901335481],[12.856962603,43.901331299],[12.856961713,43.901330726],[12.856953569,43.901334739]]]]}, "properties": {"id": null, "name": "door 6", "type": "door", "description": "door 6 door"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856909523,43.901366307],[12.856909523,43.901366307],[12.856936929,43.901393794],[12.856997521,43.901366981],[12.856974866,43.901341754],[12.856962696,43.901347285],[12.856959513,43.901343238],[12.856909523,43.901366307]]]]}, "properties": {"id": null, "name": "room 5", "type": "room", "description": "room 5 room"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856964334,43.901345734],[12.856965364,43.901346611],[12.856973392,43.901342833],[12.856972736,43.901341923],[12.856964334,43.901345734]]]]}, "properties": {"id": null, "name": "oor 5", "type": "door", "description": "oor 5 door"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856927123,43.901292952],[12.856962883,43.901330152],[12.857013061,43.901308736],[12.856975989,43.901270895],[12.856927123,43.901292952]]]]}, "properties": {"id": null, "name": "room 7", "type": "room", "description": "room 7 room"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857013061,43.901308736],[12.857027103,43.901302463],[12.857029911,43.901289917],[12.857067263,43.901271098],[12.857038898,43.901239328],[12.856975989,43.901270895],[12.857013061,43.901308736]]]]}, "properties": {"id": null, "name": "room 8", "type": "room", "description": "room 8 room"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857027103,43.901302463],[12.85703946,43.901315616],[12.857104335,43.90128506],[12.857083272,43.901263408],[12.857067263,43.901271098],[12.857029911,43.901289917],[12.857027103,43.901302463]]]]}, "properties": {"id": null, "name": "room 9", "type": "room", "description": "room 9 room"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856984344,43.901320928],[12.856985047,43.901321788],[12.856993753,43.901317691],[12.856993051,43.901316932],[12.856984344,43.901320928]]]]}, "properties": {"id": null, "name": "door 7", "type": "door", "description": "door 7 door"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857015237,43.901306713],[12.857015869,43.901307623],[12.857024084,43.90130393],[12.857023031,43.901303222],[12.857015237,43.901306713]]]]}, "properties": {"id": null, "name": "door 8", "type": "door", "description": "door 8 door"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857030894,43.901306055],[12.857035879,43.901311772],[12.857037283,43.901310962],[12.857032158,43.901305296],[12.857030894,43.901306055]]]]}, "properties": {"id": null, "name": "door 9", "type": "door", "description": "door 9 door"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857003185,43.901260999],[12.857008425,43.901266598],[12.857025278,43.901258411],[12.857020039,43.901252811],[12.857003185,43.901260999]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857025249,43.901281358],[12.857030489,43.901286958],[12.857047343,43.90127877],[12.857042103,43.901273171],[12.857025249,43.901281358]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857043036,43.901272841],[12.857048276,43.901278441],[12.857065129,43.901270254],[12.857059889,43.901264654],[12.857043036,43.901272841]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857033467,43.901288901],[12.857038707,43.901294501],[12.857055561,43.901286314],[12.857050321,43.901280714],[12.857033467,43.901288901]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856986862,43.901279087],[12.856992102,43.901284687],[12.857008955,43.901276499],[12.857003715,43.901270899],[12.856986862,43.901279087]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856992941,43.901285738],[12.856998181,43.901291338],[12.857015034,43.901283151],[12.857009794,43.901277551],[12.856992941,43.901285738]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857066564,43.901273571],[12.857071804,43.901279171],[12.857088657,43.901270984],[12.857083417,43.901265384],[12.857066564,43.901273571]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.8568914,43.901333108],[12.85689664,43.901338708],[12.856913493,43.90133052],[12.856908254,43.901324921],[12.8568914,43.901333108]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856910174,43.901356969],[12.856915414,43.901362569],[12.856932268,43.901354382],[12.856927028,43.901348782],[12.856910174,43.901356969]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856931788,43.901347235],[12.856937028,43.901352835],[12.856953882,43.901344648],[12.856948642,43.901339048],[12.856931788,43.901347235]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856940344,43.901353724],[12.856945584,43.901359324],[12.856962437,43.901351137],[12.856957197,43.901345537],[12.856940344,43.901353724]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856918701,43.901363645],[12.856923806,43.901369309],[12.856940852,43.901361332],[12.856935747,43.901355668],[12.856918701,43.901363645]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856943496,43.901382925],[12.856948736,43.901388525],[12.856965589,43.901380338],[12.856960349,43.901374738],[12.856943496,43.901382925]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856986274,43.901401094],[12.856991514,43.901406694],[12.857008367,43.901398507],[12.857003127,43.901392907],[12.856986274,43.901401094]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856963759,43.901410828],[12.856968999,43.901416428],[12.856985852,43.90140824],[12.856980613,43.901402641],[12.856963759,43.901410828]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.85694363,43.901294711],[12.856936022,43.901298656],[12.856947894,43.901310544],[12.856955502,43.901306599],[12.85694363,43.901294711]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856942116,43.901392846],[12.856947221,43.90139851],[12.856964268,43.901390533],[12.856959163,43.901384869],[12.856942116,43.901392846]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856961929,43.901384085],[12.856967034,43.90138975],[12.85698408,43.901381773],[12.856978975,43.901376109],[12.856961929,43.901384085]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856981066,43.901375812],[12.856986171,43.901381476],[12.857003218,43.901373499],[12.856998113,43.901367835],[12.856981066,43.901375812]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856984231,43.90135386],[12.856976371,43.901357539],[12.856987445,43.90136982],[12.856995305,43.901366141],[12.856984231,43.90135386]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856979728,43.901414045],[12.856971868,43.901417725],[12.856982942,43.901430006],[12.856990802,43.901426326],[12.856979728,43.901414045]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856981095,43.901414072],[12.856986335,43.901419672],[12.857003189,43.901411485],[12.856997949,43.901405885],[12.856981095,43.901414072]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857009302,43.901441829],[12.857001618,43.901445696],[12.857013257,43.901457703],[12.857020941,43.901453836],[12.857009302,43.901441829]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.85702101,43.901436962],[12.857013325,43.901440829],[12.857024964,43.901452836],[12.857032649,43.901448969],[12.85702101,43.901436962]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857050729,43.901424146],[12.857043045,43.901428014],[12.857054683,43.901440021],[12.857062368,43.901436153],[12.857050729,43.901424146]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.85709013,43.901409871],[12.857082445,43.901413738],[12.857094084,43.901425745],[12.857101768,43.901421878],[12.85709013,43.901409871]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857059735,43.901395433],[12.85705205,43.9013993],[12.857063689,43.901411307],[12.857071374,43.901407439],[12.857059735,43.901395433]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.85714484,43.901370774],[12.857137156,43.901374641],[12.857148794,43.901386648],[12.857156479,43.901382781],[12.85714484,43.901370774]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857167355,43.90135731],[12.85715967,43.901361177],[12.857171309,43.901373184],[12.857178993,43.901369316],[12.857167355,43.90135731]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.85712212,43.901285592],[12.857127675,43.901291032],[12.857144047,43.901282351],[12.857138491,43.901276912],[12.85712212,43.901285592]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857147426,43.901271778],[12.85714015,43.901276036],[12.857152963,43.901287405],[12.857160239,43.901283147],[12.857147426,43.901271778]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856907381,43.901307852],[12.856899773,43.901311796],[12.856911646,43.901323684],[12.856919254,43.901319739],[12.856907381,43.901307852]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856957364,43.901308014],[12.856949756,43.901311959],[12.856961628,43.901323846],[12.856969236,43.901319901],[12.856957364,43.901308014]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.85699834,43.901296009],[12.856990732,43.901299954],[12.857002605,43.901311842],[12.857010213,43.901307897],[12.85699834,43.901296009]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856984775,43.901282058],[12.856977167,43.901286003],[12.85698904,43.90129789],[12.856996648,43.901293945],[12.856984775,43.901282058]]]]}, "properties": {"id": null, "name": "desk ok", "type": "desk", "description": "desk ok desk"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856936929,43.901393794],[12.856963211,43.901420809],[12.857022874,43.901393555],[12.856997521,43.901366981],[12.856936929,43.901393794]]]]}, "properties": {"id": null, "name": "room 4", "type": "room", "description": "room 4 room"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856963211,43.901420809],[12.856981673,43.901440114],[12.857027152,43.901419349],[12.857008915,43.901400044],[12.856963211,43.901420809]]]]}, "properties": {"id": null, "name": "room 3", "type": "room", "description": "room 3 room"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857036383,43.901404424],[12.857068129,43.901439465],[12.857103927,43.901422269],[12.85709357,43.901410102],[12.857118787,43.901397611],[12.857107304,43.901384795],[12.857103477,43.901386741],[12.857083889,43.901387228],[12.857079836,43.90138301],[12.857036383,43.901404424]]]]}, "properties": {"id": null, "name": "room 1", "type": "room", "description": "room 1 room"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857107304,43.901384795],[12.857118787,43.901397611],[12.857145129,43.901385444],[12.857156836,43.901397773],[12.857191284,43.901381226],[12.857157962,43.901345698],[12.857134547,43.901357054],[12.857138374,43.901360948],[12.857130044,43.901373115],[12.857107304,43.901384795]]]]}, "properties": {"id": null, "name": "room 13", "type": "room", "description": "room 13 room"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857157962,43.901345698],[12.857191284,43.901381226],[12.85724667,43.90135381],[12.857207269,43.901311793],[12.857164829,43.901334505],[12.857169895,43.901340021],[12.857157962,43.901345698]]]]}, "properties": {"id": null, "name": "room 14", "type": "room", "description": "room 14 room"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857164829,43.901334505],[12.857207269,43.901311793],[12.857177325,43.901279429],[12.857136123,43.90130133],[12.857164829,43.901334505]]]]}, "properties": {"id": null, "name": "room 11", "type": "room", "description": "room 11 room"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857177325,43.901279429],[12.857153459,43.901254446],[12.857100847,43.901281475],[12.857104335,43.90128506],[12.857125991,43.901306764],[12.857136123,43.90130133],[12.857177325,43.901279429]]]]}, "properties": {"id": null, "name": "room 10", "type": "room", "description": "room 10 room"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857013475,43.901397489],[12.857014206,43.901398016],[12.857022874,43.901393555],[12.857022368,43.901392906],[12.857013475,43.901397489]]]]}, "properties": {"id": null, "name": "door 4", "type": "door", "description": "door 4 door"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.857010323,43.901401443],[12.857015388,43.901406797],[12.857016852,43.901406107],[12.85701173,43.901400916],[12.857010323,43.901401443]]]]}, "properties": {"id": null, "name": "door 3", "type": "door", "description": "door 3 door"}}, {"type": "Feature", "geometry": {"type":"MultiPolygon","coordinates":[[[[12.856981673,43.901440114],[12.857006833,43.901468827],[12.857068129,43.901439465],[12.857036383,43.901404424],[12.857019891,43.9014114],[12.857027152,43.901419349],[12.856981673,43.901440114]]]]}, "properties": {"id": null, "name": "room 2", "type": "room", "description": "room 2 room"}}]}
            L.geoJSON(states, {
            onEachFeature: onEachFeature,
           
            style: function(feature) {
                switch (feature.properties.type) {
                    case 'desk': return {color: "#ff0000"};
                    case 'room':   return {color: "white"};
                }
            }
        }).addTo(map);
      

        function onEachFeature(feature, layer) {
            // does this feature have a property named popupContent?
            if (feature.properties && feature.properties.description) {
                layer.bindPopup(feature.properties.description);
            }
        }
        /**/
    </script>
    
</body>
</html>

